\documentclass[10pt, a4paper, twoside]{amsart}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
%\usepackage[utf8x]{inputenc}
\usepackage{amsmath, amssymb, amsthm, amsfonts, mathrsfs, amsfonts}
\usepackage{mathtools} 

\usepackage{enumerate}

\usepackage[noabbrev]{cleveref}

%\usepackage{subfig}
\usepackage{pgf,tikz}
%\usetikzlibrary{arrows}

%\usepackage{natbib}
\usepackage[osf]{mathpazo} % Nice text font
\usepackage{euler} % Very nice mathmode font


% bold
\newcommand{\F}{\ensuremath{\mathbb{F}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\newcommand{\Q}{\ensuremath{\mathbb{Q}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\C}{\ensuremath{\mathbb{C}}}
% 
% calligraphic
\newcommand{\A}{\ensuremath{\mathcal{A}}}
\newcommand{\E}{\ensuremath{\mathcal{E}}}
\newcommand{\I}{\ensuremath{\mathcal{I}}}

% Delimiters (requires mathtools package)
\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\brac[]
\DeclarePairedDelimiter\cbrac\{\}
\DeclarePairedDelimiter\paren()
\DeclarePairedDelimiter{\ip}\langle\rangle
\DeclarePairedDelimiter{\nrm}\lVert\rVert
\DeclarePairedDelimiter{\ceil}\lceil\rceil

% Power set
\newcommand{\Ps}{\ensuremath{\mathcal{P}}}

 
% other things ...
\renewcommand{\c}{\ensuremath{\colon}}
\newcommand{\se}{\ensuremath{\subseteq}}
\renewcommand{\d}{\ensuremath{\ d}}
\newcommand{\Ind}{\ensuremath{\mathbb{1}}}
\newcommand{\im}{\ensuremath{\mathbf{i}}}

\newcommand{\argmin}{\operatorname*{argmin}}
\newcommand{\argmax}{\operatorname*{argmax}}
% \renewcommand\qedsymbol{\rule{1ex}{1ex}}

% course specifics
\renewcommand{\P}{\operatorname*{\ensuremath{\mathbf{P}}}} % probability measure
\newcommand{\Ev}{\operatorname*{\ensuremath{\mathbf{E}}}} %expected value
\newcommand{\Fa}{\ensuremath{\mathcal{F}}} %sigma-algebra
\newcommand{\cH}{\ensuremath{\mathcal{H}}}
\newcommand{\cD}{\ensuremath{\mathcal{D}}}
\newcommand{\cX}{\ensuremath{\mathcal{X}}}
\newcommand{\sgn}{\mathrm{sgn}}

% Solutions use a modified proof environment
\newenvironment{solution}
               {\let\oldqedsymbol=\qedsymbol
                \renewcommand{\qedsymbol}{$\blacktriangleleft$}
                \begin{proof}[Solution]}
               {\end{proof}
                \renewcommand{\qedsymbol}{\oldqedsymbol}}


\newcommand{\TODO}{\textcolor{red}{\textbf{!!!!!! }}}

\newcommand{\firstName}  {Twan}
\newcommand{\lastName}   {Koperberg}
\newcommand{\studId}     {0713309 (Leiden)}
\renewcommand{\email}    {twankop@gmail.com}

\newcommand{\firstNameII}  {Tamar}
\newcommand{\lastNameII}   {Huygen}
\newcommand{\studIdII}     {10907483 (UvA)}
\newcommand{\studIdIII}    {2556474 (VU)}
\newcommand{\emailII}     {tamar@huygen.nl}

\begin{document}
\begin{center}

  {\huge\bf Machine learning theory}\\
  {\large\sc Homeworkset 4 }\\ \vspace{1em}
  \firstName \textsc{ \lastName}, {\sc s}\studId \\
  \email\text{}\\ \smallskip
  \firstNameII \textsc{ \lastNameII}, \studIdII, \studIdIII\\
  \emailII \\ \bigskip
  \today \\\bigskip
  \hrule
  \bigskip
 \end{center}

 \section*{Exercise 6.7}
 We have shown that for a finite hypothesis class $\cH$, $\text{VCdim}(\cH) \leq \left\lfloor \log \paren*{\abs{\cH}} \right\rfloor$. However, this is just an upper bound. The VC-dimension of a class can be much lower than that:
 \subsection*{1}
 Find an example of a class $\cH$ of functions over the real interval $\cX = [1,0]$ such that $\cH$ is infinite while $\text{VCdim}(\cH) = 1$.
\begin{solution}
 Take $\cH_{=1}^{[0,1]}$ from exercise 6.2. That is, $\cH_{=1}^{[0,1]}$ denotes the collection of functions 
 $h:[0,1]\to \cbrac{0,1}$ such that $\abs{\cbrac{x \in [0,1] \c h(x)=1}}=1$.\\
   Threshold functions?
 \TODO
\end{solution}
\subsection*{2}
Give an example of a finite hypothesis class $\cH$ of functions over the real interval $\cX = [0,1]$, where $\text{VCdim}(\cH) = \left\lfloor \log \paren*{\abs{\cH}} \right\rfloor$.
 \begin{solution}
   Let $\cH$ denote any hypotheses class with $\abs{\cH}=1$. Then $\mathrm{VCdim}(\cH)=0$ and $\log_2(\abs{\cH})=0$.\\
   \TODO
   Let $s_1,s_2 \in \cbrac{0,1}$ and let $ \cH$ be the hypothesis class that consists of all functions $h: [0,1] \mapsto \cbrac{s_1,s_1}$ that have
   \begin{equation*}
     h(x) = \begin{cases}
         s_1 & \mbox{if } x \leq \frac{1}{2} \\
         s_2 & \mbox{if } x > \frac{1}{2}
       \end{cases}
     \end{equation*}
     We can see that any set of two points taken from $[1.0]$ is shattered by $\cH$, but with any set of three points or more, we cannot give the same labeling to the outer two points, but a different one to the middle point(s). So $\text{VCdim} = 2$.
   We can see that $\abs{\cH} = 4$ and $\text{VCdim}(\cH) = 2 = \lfloor \log_2\paren*{\abs{\cH}} \rfloor$.
 \end{solution}
 
\section*{Exercise 6.8}
It is often the case that the VC-dimension of a hypothesis class equals (or can be bounded above by) the number of parameters one needs to set in order to define each hypothesis in the class. For instance, if $\cH$ is the class of axis aligned rectangles in $\R^d$, then $\text{VCdim}(\cH) = 2d$, which is equal to the number of parameters used to define a rectangle in $\R^d$. Here is an example that shows that this is not always the case. We will see that a hypothesis class might be very complex and not even learnable, although it has a small number of parameters.

Consider the domain $\cX = \R$, and the hypothesis class
\begin{equation*}
  \cH = \cbrac{x \mapsto \left\lceil \sin\paren*{\theta x} \right\rceil : \theta \in \R }
\end{equation*}
(here, we take $\lceil -1 \rceil = 0$). Prove that $\text{VCdim}(\cH) = \infty$.\\
\textit{Hint:} There is more than one way to prove the required result. One option is by applying the following lemma: If $0 . x_1 x_2 x_3 \ldots$, is the binary expansion of $x \in (0,1)$, then for any natural number $m$, $\lceil \sin \paren*{2^m \pi x} \rceil = \paren*{1-x_m}$, provided that $\exists k \leq m$ s.t. $x_k =1$.
\begin{solution}
Let $\sum_{n=1}^{\infty} \frac{x_n}{2^n}$ be the binary expansion of a real number $x \in \paren*{0,1}$. And let $C$ be a subset of $\paren*{0,1}$, of size $m$, such that the binary expansions of the first $m$ binary digits are all possible $2^m$ combinations of zero and one. Let the $y = \paren*{y^1,y^2, \ldots, y^m} =  \cbrac{0,1}^m$ be an arbitrary labeling. Now for each $x^j \in C$ there exists a number $i \in [m]$ and an $h \in \cH$ such that $h(x_i^j) = \lceil \sin \paren*{2^l \pi x}\rceil = 1-x_i^j = y_i $ So if we take $\theta = 2^i \pi$, we have that $\cH$ shatters $C$. And since $C$ can be of arbitrary large size, we have shown that $\text{VCdim}(\cH) = \infty$.
\TODO
\end{solution}
\section*{Exercise 6.9}
Let $\cH$ be the class of signed intervals, that is, \\
$\cH = \cbrac{h_{a,b,s}:a \leq b, s \in \cbrac{-1,1}}$ where
\begin{equation*}
  h_{a,b,s}\paren*{x} =
  \begin{cases} 
    s &\mbox{if } x \in [a,b] \\
    -s &\mbox{if } x \notin [a,b]
  \end{cases}
\end{equation*}
Calculate $\text{VCdim}(\cH)$.
 \begin{solution}
  We will show that $\mathrm{VCdim}(\cH)=3$. Consider the set $C=\cbrac{1,2,3}$. Let $f:C \to \cbrac{-1,1}$ be a function.
  Take $s = f(2)$, $a=\min{x \in C \c f(x)=f(2)}$ and $b=\max{x \in C \c f(x)=f(2)}$. Then we have that $h_{a,b,s}|_{C}=f$,
  so $C$ is shattered by $\cH$. Let $D=\cbrac{x_1,x_2,x_3,x_4}$ be given. Without loss of generality, we can assume that $x_1<x_2<x_3<x_4$. Define $g:D\to\cbrac{-1,1}$ by
  \begin{equation*}
   g(x)=
   \begin{cases}
    1 & \text{ if }x\in \cbrac{x_1,x_3}, \\
    -1 & \text{ if }x\in \cbrac{x_2,x_4}.
   \end{cases}
  \end{equation*}
Suppose ad absurdum that there exists an $h_{a,b,s} \in \cH$ with $h_{a,b,s}|_{D}=g$. Then if $x_2 \in [a,b]$ it follows that $x_3  \notin [a,b]$ and $x_4 \in [a,b]$, which gives a contradiction. However, we also have that if $x_2 \notin [a,b]$
it follows that $x_1  \in [a,b]$ and $x_3 \in [a,b]$, which gives a contradiction. 
Both cases give a contradiction, hence no such $h_{a,b,s}$ exists.

It follows that no subset of $\R$ with four elements is shattered by $\cH$.
\TODO
% Moeten we niet ook nog laten zien dat er geen set bestaat met meer dan 4 elementen die wordt geshattert door $\cH$? Ik snap dat dat intiutief al duidelijk is, maar de hele opgave is eigenlijk al intuitief duidelijk.
 \end{solution}
\section*{Exercise 6.11}
\textbf{VC of union:} Let $\cH_1, \ldots , \cH_r$ be the hypothesis classes over some fixed domain set $\cX$. Let $d = \max_i \text{VCdim}(\cH_i)$ and assume for simplicity that $d \geq 3$.
\subsection*{1}
Prove that
\begin{equation*}
  \text{VCdim}\paren*{\bigcup_{i=1}^r\cH_i}\leq 4d \log \paren*{2d} + 2 \log \paren*{r}.
\end{equation*}
\textit{Hint:} Take the set of $k$ examples and assume that they are shattered by the union class. Therefore, the union class can produce all $2^k$ possible labelings on these examples. Use Sauer's lemma to show that the union class cannot produce more than $rk^d$  labelings. Therefore $2^k < rk^d$. Now use Lemma A.2.

Lemma A.2:\\
Let $a \geq 1$ and $b>0$. Then: $x \geq 4a \log \paren{2a} +2b \implies x \geq a \log \paren{x}+b$.
\begin{solution}
  To prove this, we make use of the hint and take a set of k examples and assume they are shattered by the union class.\\
  Now for the growth function of $k$ it holds that:
  \begin{equation*}
    \tau_{\cup^r_{i=1} \cH_i}\paren*{k} = \max_{C\subseteq \cX : \abs{C} = k} \abs*{\paren*{\bigcup_{i=1}^r \cH_i}_C}.
  \end{equation*}
  The amount of functions each subset $\cH_i$ contributes to this maximum is lesser or equal to the growth function of that subset, that is:
  \begin{equation*}
    \max_{C\subseteq \cX : \abs{C} = k} \abs*{\paren*{\bigcup_{i=1}^r \cH_i}_C} \leq \sum_{i = 1}^r \max_{C\subseteq \cX : \abs{C} = k} \abs{\cH_{i,C}}.
  \end{equation*}
  According to Sauer's lemma, we have that:
  \begin{equation*}
    \sum_{i = 1}^r \max_{C\subseteq \cX : \abs{C} = k} \abs{\cH_{i,C}} \leq \sum_{i=1}^r \sum_{j=1}^d {k \choose j} \leq rk^d
  \end{equation*}
  Now indeed because the union class shatters the set of $k$ examples, we have that the union class can produce all $2^k$ labelings and thus it holds that $2^k < rk^d$. Hoe de f moeten we nu dat lemma gebruiken? Die implicatie en die $\geq$ staan de verkeerde kant op, of kun je die dan juist op een slimme manier omdraaien?
  \begin{align*}
    2^k < rk^d & \iff k < \frac{\log r k^d}{\log(2)}
  \end{align*}
\TODO
\end{solution}
\subsection*{2}
Prove that for $r = 2$ it holds that
\begin{equation*}
  \text{VCdim}\paren*{\cH_1 \cup \cH_2}\leq 2d +1.
\end{equation*}
\begin{solution}
\TODO
\end{solution}

\end{document}




%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
